ğŸ§© Step 1 â€” Go to Snort directory

cd /etc/snort/rules


---

ğŸ§¾ Step 2 â€” Edit your local rule file

sudo nano local.rules


---

ğŸ§± Step 3 â€” Add a Snort rule

Paste this rule inside the file:

alert icmp any any -> any any (msg:"ICMP Ping Detected"; sid:1000001; rev:1;)

Press Ctrl + O â†’ Enter â†’ Ctrl + X to save and exit.


---

âš™ï¸ Step 4 â€” Check if local.rules is included in Snort config

Open main config file:

sudo nano /etc/snort/snort.conf

Search for this line:

include $RULE_PATH/local.rules

If itâ€™s commented (with #), remove the # to enable it.
Save and exit (Ctrl + O, Enter, Ctrl + X).


---

ğŸ§ª Step 5 â€” Test Snort configuration

Run a configuration test:

sudo snort -T -c /etc/snort/snort.conf

âœ… You should see:

Snort successfully validated the configuration!
Snort exiting


---

ğŸš€ Step 6 â€” Run Snort with your rule

Run Snort in alert mode on your network interface (example: eth0):

sudo snort -A console -q -c /etc/snort/snort.conf -i eth0

If youâ€™re not sure about your interface, check with:

ip link show


---

ğŸ§² Step 7 â€” Generate ICMP traffic (to trigger the rule)

Open another terminal and ping any IP:

ping 8.8.8.8

You should see Snort print alerts like:

[**] [1:1000001:1] ICMP Ping Detected [**]


---

ğŸ“‚ Step 8 â€” Check saved alerts (optional)

Alerts are saved in:

sudo cat /var/log/snort/alert


---
