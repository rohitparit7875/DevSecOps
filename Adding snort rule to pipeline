🧩 Step 1 — Go to Snort directory

cd /etc/snort/rules


---

🧾 Step 2 — Edit your local rule file

sudo nano local.rules


---

🧱 Step 3 — Add a Snort rule

Paste this rule inside the file:

alert icmp any any -> any any (msg:"ICMP Ping Detected"; sid:1000001; rev:1;)

Press Ctrl + O → Enter → Ctrl + X to save and exit.


---

⚙️ Step 4 — Check if local.rules is included in Snort config

Open main config file:

sudo nano /etc/snort/snort.conf

Search for this line:

include $RULE_PATH/local.rules

If it’s commented (with #), remove the # to enable it.
Save and exit (Ctrl + O, Enter, Ctrl + X).


---

🧪 Step 5 — Test Snort configuration

Run a configuration test:

sudo snort -T -c /etc/snort/snort.conf

✅ You should see:

Snort successfully validated the configuration!
Snort exiting


---

🚀 Step 6 — Run Snort with your rule

Run Snort in alert mode on your network interface (example: eth0):

sudo snort -A console -q -c /etc/snort/snort.conf -i eth0

If you’re not sure about your interface, check with:

ip link show


---

🧲 Step 7 — Generate ICMP traffic (to trigger the rule)

Open another terminal and ping any IP:

ping 8.8.8.8

You should see Snort print alerts like:

[**] [1:1000001:1] ICMP Ping Detected [**]


---

📂 Step 8 — Check saved alerts (optional)

Alerts are saved in:

sudo cat /var/log/snort/alert


---
